#+title: AR - Lesson 04
#+date: <2021-10-20 lun>
#+teacher: Miriam Di Ianni
#+setupfile: ../../org-template/appunti.org

* Grafi geometrici aleatori e reti wireless
  I modelli fin'ora visti (Erdős–Rényi e rich-get-richer) sono tutti modelli di tipo /virtuale/, ovvero
  descrivono le /connessioni logiche/ tra i nodi, trascurando del tutto l'implementazione fisica della rete.
  Spesso però si necessita di modellare reti che debbano essere poi /implementate fisicamente/.
  Quando si affronta un problema reale bisogna sempre considerare due fattori:
  1. la *fattibilità*
  2. le *risorse necessarie*
  Infatti, non basta sapere che è fisicamente possibile costruire una rete che è stata precedentemente modellizzata,
  ma bisogna sempre tener conto del costo in termine di risorse.
  Supponendo che non si disponga di risorse infite, quello che generalmente si desidera è sempre /minimizzare i costi/.\\
  In ogni caso, quando bisogna implementare una rete fisica, bisogna sempre considerare la *struttura geometrica* che dovrà avere
  e lo *spazio* in cui dovrà essere costruita.

** Grafo Geometrico
   Siano uno *spazio metrico* $(\mathbb{R}^d, \Vert \cdot \Vert )$ di dimensione $d \geq 1$, e una costante $r > 0$ detto *raggio*.
   Un /grafo geometrico/ $G$ è composto dai seguenti insiemi:
   1. $V \subseteq \mathbb{R}^d$
   2. $E := \lbrace (a,b) \in V^2 : \Vert a-b \Vert \leq r \rbrace$
   La maggior parte delle volte ci si trova a considerare uno spazio bidimensionale $\mathbb{R}^2$, con /norma euclidea/
   e raggio unitario $r = 1$.
   In questo caso esiste un arco tra due nodi $a,b$ solo se $\sqrt{(x_1 - x_b)^2 + (y_1 - y_b)^2} \leq 1$.
   Questo modello è anche noto come *unique disk graph*.

** Grafo Geometrico Aleatorio
   Siano due costanti $n \in \mathbb{N}$ ed $0 < r \leq \sqrt{2}$.
   Un *grafo geometrico aleatorio* $G(n,r)$ è un particolare tipo di grafo aleatorio in cui vengono scelti $n$ nodi /u.a.r./
   nell'insieme \(\left[ 0,1 \right] \times \left[ 0,1 \right]\).\\

   Notare che per $r \rightarrow 0$ il grafo diventa sempre più sparso, mentre per $r = \sqrt{2}$ il grafo risultate sarà /completo/[fn:1].
   L'ultima affermazione è vera perché scegliendo i nodi in quadrato di lato 1, due nodi possono essere distanti _al più_ $\sqrt{2}$, ovvero
   la lunghezza della diagonale di una quadrato.\\

   =*inserire immagine*=
   
   Questo particolare modello può avere numerosi riscontri pratici.
   Per esempio consideriamo una situazione in cui si hanno a disposizione $n$ sensori ambientali per l'acquisizione di dati utili allo studio di
   fenomi atmosferici, e di doverli disporre in una vasta area di 10 $km^2$.
   Prima di spargere i sensori è possibile impostare un raggio $r$ di trasmissione, utile ai sensori per scambiarsi informazioni.
   Ovviamente maggiore è il raggio di trasmissione $r$, maggiore sarà il cunsumo di batteria dei sensori.
   Questi sensori inoltre verranno rilasciati nell'ambiente in maniera casuale lanciandoli da un aereo che sorvolerà l'area.\\
   Si vuole quindi trovare il più piccolo valore di $r$ in relazione ad $n$ (che d'ora in poi chiameremo $r(n)$) tale che con /buona probabilità/[fn:2]
   la rete di sonsori $G(n, r(n))$ risulti connessa, usando così meno batteria possibile.
   
** Reti Wireless ad-hoc
   Quello precedentemente descritto è un caso di *reti wireless ad-hoc*.
   In questo contesto si considera un insieme di $n$ dispositivi (calcolatori, sensori, ecc...) dislocati in una data area, e ognuno dei quali dotato
   un trasmettitore wireless con un fissato /raggio di trasmissione/.
   Come prima, più è ampio il raggio di trasmissione maggiore sarà il consumo di batteria del dispositivo.
   Ongi dispositivo $x$ può trasmettere i messaggi solamente ai dispositivi situati /entro/ il suo raggio di trasmissione $r_x$.
   Notare che non è detto che se un dispositivo $y$ è dentro il raggio di $x$, necessariamente $y$ sia in grado di trasmettere ad $x$.\\

   Si può quindi modellare questo tipo di rete con un *grafo di comunicazione* (*diretto*) dove l'insieme dei nodi corrisponde a quello dei
   dispositivi, mentre esiste l'arco diretto $(x,y)$ se e solo se $\Vert x - y \Vert \leq r_x$.

   #+caption: Esempio di rete wireless
   #+ATTR_HTML: :style max-width: 250px
   [[file:../images/ar-lesson04-img1.png]]

   #+caption: Grafo delle comunicazioni associato
   #+ATTR_HTML: :style max-width: 250px
   [[file:../images/ar-lesson04-img2.png]]   
   
   In questo modello è possibile anche mandare messaggi a nodi non direttamente connessi, a patto che siano nelle relative componenti connesse.
   Per esempio, se il nodo $v_1$ volesse mandare un messagio al nodo $v_4$ potrebbe farlo tramite il /cammino/ $\langle (v_1,v_2), (v_2,v_3), (v_3,v_4) \rangle$.
   Notare però che queste comunicazioni *multi-hop* non sono simmetriche, in quanto nel grafo delle comunicazioni non esiste alcun cammino diretto che parte da $v_4$
   e termina in $v_1$.\\

   Perciò se si vuole che ogni nodo sia in grado di comunicare con tutti gli altri è necessario che i raggi trasmissione siano scelti in modo tale che
   il grafo delle comunicazioni sia *fortemente connesso*[fn:3].
   Banalmente questo si può ottenere ponendo il raggio di ogni nodo pari alla distanza con il nodo ad esso più lontano, ovvero
   \[
   r_v = \max_{x \in V \setminus \lbrace v \rbrace}{\lbrace \Vert v - x \Vert \rbrace}
   \]
   Questo approccio potrebbe risultare però parecchio dispendioso in termini di utilizzo di batteria dei dispositivi.
   Sarebbe preferibile scegliere dei raggi di trasmissione tali che minimizzino il più possibile lo spreco di batteria.\\

   Possiamo modellizzare questo problema come nell'esempio della precedente sezione, ovvero assumendo che tutti i nodi abbiano uno stesso
   raggio di trasmissione $r$, e senza perdere di generalità che la regione in cui distribuire i nodi sia un quadrato normalizzato \(Q \equiv \left[ 0,1 \right]^2\).
   Ovviamente $r$ deve essere una funzione di $n$, in quanto se $r$ fosse fissato la densità del grafo geometrico aleatorio risultante dipnderebbe da $n$.
   Invece si vuole che al variare di $n$ il grafo $G(n,r(n))$ sia sempre fortemente connesso (con buona probabilità).\\

   Osservare che se $r$ è uguale per tutti i nodi allora non ha senso parlare di grafo diretto, in quanto se un nodo $x$ riesce a trasmettere direttamente a un nodo
   $y$ allora anche $y$ può trasmettere in modo diretto a $x$.\\

   Formalmente la domanda alla quale si vuole dare una risposta è:
   #+begin_quote
   dati $n$ punti distribuiti uniformemente a caso nel quadrato unitario $Q$, calcolare il valore _minimo_ di $r(n)$ tale che $G(n, r(n))$ risulti connesso con buona probabilità
   #+end_quote

** Connettività di $G(n, r(n))$
   In questa sezione verrà dimostrato la seguente affermazione:
   #+begin_quote
   Sia $r^{\star}(n)$ il minimo valore di $r(n)$ tale che garantisce con ragionevole probabilità la connettività di $G(n,r(n))$.
   Allora \(r^{\star}(n) \in \Theta\left( \sqrt{\frac{\ln{n}}{n}} \right)\).
   #+end_quote
   Per dimostrare la precedente affermazione è necessario dimostrare due teoremi che mostrano rispettivamente una limitazione /superiore/ ed una /inferiore/
   per il minimo raggio di trasmissione $r^{\star}(n)$.

*** Teorema 1 - delimitazione superiore
    *Enunciato:* esiste una costante $\gamma_1 > 0$ tale che se \(r(n) \geq \gamma_1\left( \sqrt{\frac{\ln{n}}{n}} \right)\),
    allora $G(n, r(n))$ è connesso con alta probabilità[fn:4].\\

    *Proof:* definiamo una quantità $k(n)$ (dipendente da $n$), e partizioniamo il quadrato unitario $Q$ in $\left(k(n)\right)^2$
    celle ciascuna di lato $\frac{1}{k(n)}$.\\
    Poniamo $r(n)$ pari alla lunghezza della diagonale di un rettangolo composto da due celle adiacenti, ovvero
    \[
    r(n) = \sqrt{\left(\frac{1}{k(n)}\right)^2 + \left(\frac{2}{k(n)}\right)^2} = \frac{\sqrt{5}}{k(n)}
    \]

    #+caption: Immagine esplicativa
    #+ATTR_HTML: :style max-width: 250px
    [[file:../images/ar-lesson04-img3.png]]

    In questa maniera, ciascun nodo sarà certamente collegato a _tutti_ i nodi nelle celle adiacenti alla sua.
    
    #+ATTR_HTML: :style max-width: 250px
    [[file:../images/ar-lesson04-img4.png]]

    Se /con alta probabilità/ ciascuna cella ha _almeno_ un nodo allora è anche vero che con alta probabilità $G(n,r(n))$ è connesso.\\

    Dimostriamo quindi che è possibile scegliere un $k(n)$ tale che /w.h.p./ nessuna cella di $Q$ è vuota.
    Per calcolare questa probabilità è più semplice partire dal calcolo dell'/evento complementare/, ovvero calcolare la probabilità dell'evento
    che esiste _almeno_ una cella vuota.\\

    Sia $C$ una cella: iniziamo col calcolare una /delimitazione superiore/ alla probabilità che essa sia vuota $\mathcal{P}(C = \emptyset)$.
    L'evento "$C = \emptyset$" può essere espresso come l'instersezione degli eventi $\lbrace i \not\in C \rbrace_{i \in \left[ n \right]}$, ovvero
    \[
    \mathcal{P}(C = \emptyset) = \mathcal{P}\left( \bigcap_{1 \leq i \leq n} i \not\in C \right)
    \]
    Dato che ogni nodo è posizionato in maniera totalmente indipendente dagli altri, e dato che la probabilità dell'intersezione di eventi indipendenti
    è pari al prodotto dei singoli, è vero che
    \[
    \mathcal{P}\left( \bigcap_{1 \leq i \leq n} i \not\in C \right) = \prod_{1 \leq i \leq n} \mathcal{P}\left( i \not\in C \right)
    \]

    Non resta che calcolare la probabilità $\mathcal{P}\left( i \not\in C \right)$ che un nodo $i$ non "cada" nella cella $C$.
    Osserviamo che la probabilità dell'evento complementare, ovvero la probabilità dell'evento che $i$ cada in $C$ può essere ricavata semplicemente
    con la regola /"casi favorevoli fratto casi possibili"/, che in questo caso si traduce come /"area di $C$ fratto area di $Q$"/, ovvero
    \[ \mathcal{P}\left( i \in C \right) = \frac{|C|}{|Q|} = \frac{1}{(k(n))^2}\]
    Di conseguenza $\mathcal{P}\left( i \not\in C \right) = 1 - \mathcal{P}\left( i \in C \right) = 1 - \frac{1}{(k(n))^2}$.
    Perciò
    \[
    \mathcal{P}(C = \emptyset) = \mathcal{P}\left( \bigcap_{1 \leq i \leq n} i \not\in C \right)
    = \prod_{1 \leq i \leq n} \mathcal{P}\left( i \not\in C \right)
    = \left(  1 - \frac{1}{(k(n))^2} \right)^n
    \]

    Calcolata la probabilità che la cella $C$ sia vuota, si vuole ora calcolare la probabilità dell'evento che esista _almeno_ una cella vuota, ovvero
    \[
    \mathcal{P}(\exists C : C = \emptyset) =
    \mathcal{P}(\bigcup_{C \in Q} \lbrace C = \emptyset \rbrace )
    \]
    Rimarcando il concetto di *Union Bound* che dice che la probabilità dell'unione di eventi è minore o uguale della somma delle loro probabilità
    possiamo dare la seguente delimitazione superiore
    \[
    \mathcal{P}(\exists C : C = \emptyset) \leq
    \sum_{C \in Q} \mathcal{P}(C = \emptyset ) =
    (k(n))^2 \left(  1 - \frac{1}{(k(n))^2} \right)^n
    \]

    Ricordando che $r(n) = \frac{\sqrt{5}}{k(n)}$, possiamo sostituire $k(n)$ con $\frac{\sqrt{5}}{r(n)}$, ottenendo
    \[
    \mathcal{P}(\exists C : C = \emptyset) \leq
    \frac{5}{(r(n))^2} \left(  1 - \frac{(r(n))^2}{5} \right)^n
    \]

    A questo punto poniamo $r(n) = \gamma_1\left( \sqrt{\frac{\ln{n}}{n}} \right)$, ottenendo che
    \[
    \mathcal{P}(\exists C : C = \emptyset) \leq
    \frac{5n}{\gamma^2_1 \ln{n}} \left(  1 - \frac{\gamma^2_1 \ln{n}}{5n} \right)^n
    \]

    Prima di procedere (e concludere) con la dimostrazione della delimitazione superiore è necessario enunciare e dimostrare un /lemma tecnico/

    #+begin_quote
    *Lemma:* $\forall x \in \mathbb{R}$ vale la disuguaglianza $1 - x \leq e^{-x}$.
    Inoltre se $x \neq 0$ allora la disuguaglianza è stretta, ovvero $1 - x e^{-x}$.\\

    *Proof:*
    Sia la funzione $G(x) = 1 - x - e^{-x}$.
    Calcoliamo la derivata prima di $G$, ovvero $G'(x) = e^{-x} - 1$.
    Studiando il segno di $G'$ si nota che
    \[e^{-x} - 1 \geq 0 \implies e^{-x} \geq 1 \implies e^{-x} \geq e^0\]
    ovvero che $G'(x) \geq 0$ per $x \leq 0$.\\
    Inoltre poiché $G'$ si annulla solamente per $x=0$, allora possiamo affermare che $x=0$ è il punto di massimo globale di $G$.\\

    Infine, dato che $G(0) = 0$ (e questo è il punto di massimo), possiamo affermare che $1-x \leq e^{-x}$ per ogni $x \in \mathbb{R}$.
    \[G(x) \leq G(0) \implies 1 - x - e^{-x} \leq 0 \implies 1 - x \leq e^{-x}\]
    $\square$
    #+end_quote

    In virtù del precedente Lemma, poniamo \(x = \frac{\gamma^2_1 \ln{n}}{5n}\), e dato che \(\frac{\gamma^2_1 \ln{n}}{5n} \neq 0\), avremo che
    \[
    1 - \frac{\gamma^2_1 \ln{n}}{5n} < e^{-\frac{\gamma^2_1 \ln{n}}{5n}}
    \]
    A questo punto non resta che eseguire qualche passaggio algebrico
    \begin{align*}
      \mathcal{P}(\exists C : C = \emptyset)
      &\leq \frac{5n}{\gamma^2_1 \ln{n}} \left(  1 - \frac{\gamma^2_1 \ln{n}}{5n} \right)^n\\
      &< \frac{5n}{\gamma^2_1 \ln{n}} \left( e^{-\frac{\gamma^2_1 \ln{n}}{5n}} \right)^n\\
      &= \frac{5n}{\gamma^2_1 \ln{n}} e^{-\frac{\gamma^2_1 \ln{n}}{5}}\\
      &= \frac{5n}{\gamma^2_1 \ln{n}} n^{-\frac{\gamma^2_1}{5}}\\
      &< \frac{5n}{\gamma^2_1} n^{-\frac{\gamma^2_1}{5}}\\
      &= \frac{5}{\gamma^2_1} n^{1-\frac{\gamma^2_1}{5}}
    \end{align*}

    Osserviamo ora che l'esponente $1-\frac{\gamma^2_1}{5} < 0$ per $\gamma_1 > \sqrt{5}$.\\

    In conclusione, scegliendo un qualsiasi $\gamma_1 > \sqrt{5}$ e ponendo $b = \frac{5}{\gamma^2_1}$ e $c = - \left( 1-\frac{\gamma^2_1}{5} \right) = \frac{\gamma^2_1}{5} - 1$,
    avremo che la probabilità che esista almeno una cella vuota è
    \[
    \mathcal{P}(\exists C : C = \emptyset) < \frac{b}{n^c} \in \left( \frac{1}{n} \right)^{\Omega(1)}
    \]
    e che quindi con alta probabilità non ci sono celle vuote
    \[
    \mathcal{P}\left( \forall C \subseteq Q \; \exists x \in V : x \in Q \right) > 1 - \left( \frac{1}{n} \right)^{\Omega(1)}
    \]
    $\square$.
    
*** Teorema 2 - delimitazione inferiore
    
[fn:1] ovvero una /clique/ di $n$ nodi.
[fn:2] perché $G(n, r(n))$ è un evento aleatorio, e quindi si possono solo fare previsioni probabilistiche.
[fn:3] ovvero che per ogni coppia di nodi $x,y$ esista un cammino diretto da $x$ ad $y$ e un cammino diretto da $y$ ad $x$.
[fn:4] con probabilità _almeno_ \(1 - \left(\frac{1}{n}\right)^{\Omega(1)}\)
